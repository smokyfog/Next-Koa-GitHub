{"ast":null,"code":"import \"antd/lib/tabs/style/css\";\nimport _Tabs from \"antd/lib/tabs\";\nimport \"antd/lib/icon/style/css\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/button/style/css\";\nimport _Button from \"antd/lib/button\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nconst api = require('../lib/api');\n\nimport { useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport Router, { withRouter } from 'next/router';\nimport Repo from '../components/Repo';\nimport LRU from 'lru-cache';\nimport getConfig from 'next/config';\nconst {\n  publicRuntimeConfig\n} = getConfig();\nconst cache = new LRU({\n  maxAge: 1000 * 60 * 10 // 十分钟内不会使用缓存的数据就会被删除\n\n});\nlet cachedUserRepos;\nlet cachedUserStaredRepos;\nconst isServer = true;\n\nfunction Index({\n  userRepos,\n  userStaredRepos,\n  user,\n  router\n}) {\n  const tabKey = router.query.key || '1';\n  useEffect(() => {\n    if (!isServer) {\n      cachedUserRepos = userRepos;\n      cachedUserStaredRepos = userStaredRepos; // if(userRepos) {\n      //   cache.set('userRepos', userRepos)\n      // }\n      // if(userStaredRepos) {\n      //   cache.set('userStaredRepos', userStaredRepos)\n      // }\n\n      const timeout = setTimeout(() => {\n        cachedUserRepos = null;\n        cachedUserStaredRepos = null;\n      }, 1000 * 60 * 10);\n    }\n  }, [userRepos, userStaredRepos]);\n\n  if (!user || !user.id) {\n    return __jsx(\"div\", {\n      className: \"jsx-3088588873\" + \" \" + \"root\"\n    }, __jsx(\"p\", {\n      className: \"jsx-3088588873\"\n    }, \"\\u4EB2\\uFF0C\\u60A8\\u8FD8\\u6CA1\\u6709\\u767B\\u5F55\\u54E6\"), __jsx(_Button, {\n      type: \"primary\",\n      href: publicRuntimeConfig.OAUTH_URL\n    }, \"\\u70B9\\u51FB\\u767B\\u5F55\"), __jsx(_JSXStyle, {\n      id: \"3088588873\"\n    }, \".root.jsx-3088588873{height:400px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFxyZWFjdFN0dWR5XFxOZXh0LUtvYS1HaXRIdWJcXG5leHQtZ2l0aHViXFxwYWdlc1xcaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBa0RXLEFBRzRCLGFBQ0EsMEVBQ1MsOEVBQ0MsbUdBQ0osNkZBQ3JCIiwiZmlsZSI6IkQ6XFxyZWFjdFN0dWR5XFxOZXh0LUtvYS1HaXRIdWJcXG5leHQtZ2l0aHViXFxwYWdlc1xcaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcbmNvbnN0IGFwaSA9IHJlcXVpcmUoJy4uL2xpYi9hcGknKVxyXG5pbXBvcnQgeyB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcclxuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJ1xyXG5pbXBvcnQgeyBCdXR0b24sIEljb24sIFRhYnMgfSBmcm9tICdhbnRkJ1xyXG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnXHJcbmltcG9ydCBSb3V0ZXIsIHsgd2l0aFJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJ1xyXG5pbXBvcnQgUmVwbyBmcm9tICcuLi9jb21wb25lbnRzL1JlcG8nXHJcbmltcG9ydCBMUlUgZnJvbSAnbHJ1LWNhY2hlJ1xyXG5cclxuaW1wb3J0IGdldENvbmZpZyBmcm9tICduZXh0L2NvbmZpZydcclxuY29uc3QgeyBwdWJsaWNSdW50aW1lQ29uZmlnIH0gPSBnZXRDb25maWcoKVxyXG5jb25zdCBjYWNoZSA9IG5ldyBMUlUoe1xyXG4gIG1heEFnZTogMTAwMCAqIDYwICogMTAgIC8vIOWNgeWIhumSn+WGheS4jeS8muS9v+eUqOe8k+WtmOeahOaVsOaNruWwseS8muiiq+WIoOmZpFxyXG59KVxyXG5cclxubGV0IGNhY2hlZFVzZXJSZXBvcztcclxubGV0IGNhY2hlZFVzZXJTdGFyZWRSZXBvcztcclxuY29uc3QgaXNTZXJ2ZXIgPSB0eXBlb2YgIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCdcclxuXHJcbmZ1bmN0aW9uIEluZGV4ICh7IHVzZXJSZXBvcywgdXNlclN0YXJlZFJlcG9zLCB1c2VyLCByb3V0ZXIgfSkge1xyXG4gIFxyXG4gIGNvbnN0IHRhYktleSA9IHJvdXRlci5xdWVyeS5rZXkgfHwgJzEnXHJcbiAgXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmKCFpc1NlcnZlcikge1xyXG4gICAgICBjYWNoZWRVc2VyUmVwb3MgPSB1c2VyUmVwb3NcclxuICAgICAgY2FjaGVkVXNlclN0YXJlZFJlcG9zID0gdXNlclN0YXJlZFJlcG9zXHJcbiAgICAgIC8vIGlmKHVzZXJSZXBvcykge1xyXG4gICAgICAvLyAgIGNhY2hlLnNldCgndXNlclJlcG9zJywgdXNlclJlcG9zKVxyXG4gICAgICAvLyB9XHJcbiAgICAgIC8vIGlmKHVzZXJTdGFyZWRSZXBvcykge1xyXG4gICAgICAvLyAgIGNhY2hlLnNldCgndXNlclN0YXJlZFJlcG9zJywgdXNlclN0YXJlZFJlcG9zKVxyXG4gICAgICAvLyB9XHJcbiAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBjYWNoZWRVc2VyUmVwb3MgPSBudWxsXHJcbiAgICAgICAgY2FjaGVkVXNlclN0YXJlZFJlcG9zID0gbnVsbFxyXG4gICAgICB9LCAxMDAwICogNjAgKiAxMClcclxuICAgIH1cclxuICB9LFt1c2VyUmVwb3MsIHVzZXJTdGFyZWRSZXBvc10pXHJcblxyXG4gIGlmICghdXNlciB8fCAhdXNlci5pZCkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb290XCI+XHJcbiAgICAgICAgPHA+5Lqy77yM5oKo6L+Y5rKh5pyJ55m75b2V5ZOmPC9wPlxyXG4gICAgICAgIDxCdXR0b24gdHlwZT1cInByaW1hcnlcIiBocmVmPXtwdWJsaWNSdW50aW1lQ29uZmlnLk9BVVRIX1VSTH0+XHJcbiAgICAgICAgICDngrnlh7vnmbvlvZVcclxuICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICA8c3R5bGUganN4PlxyXG4gICAgICAgICAge2BcclxuICAgICAgICAgICAgLnJvb3Qge1xyXG4gICAgICAgICAgICAgIGhlaWdodDogNDAwcHg7XHJcbiAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIGB9XHJcbiAgICAgICAgPC9zdHlsZT5cclxuICAgICAgPC9kaXY+XHJcbiAgICApXHJcbiAgfVxyXG5cclxuICBjb25zdCB7XHJcbiAgICBhdmF0YXJfdXJsLCBsb2dpbiwgbmFtZSwgYmlvLCBlbWFpbCxcclxuICB9ID0gdXNlclxyXG5cclxuICBjb25zdCBoYW5kbGVUYWJDaGFuZ2UgPSAoYWN0aXZlS2V5KSA9PiB7XHJcbiAgICBSb3V0ZXIucHVzaChgLz9rZXk9JHthY3RpdmVLZXl9YClcclxuICB9XHJcbiAgcmV0dXJuIChcclxuICAgIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInVzZXItaW5mb1wiPlxyXG4gICAgICAgIDxpbWcgc3JjPXthdmF0YXJfdXJsfSBhbHQ9XCJcIiBjbGFzc05hbWU9XCJhdmF0YXJcIiAvPlxyXG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImxvZ2luXCI+e2xvZ2lufTwvc3Bhbj5cclxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJuYW1lXCI+e25hbWV9PC9zcGFuPlxyXG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImJpb1wiPntiaW99PC9zcGFuPlxyXG4gICAgICAgIDxwIGNsYXNzTmFtZT1cImVtYWlsXCI+XHJcbiAgICAgICAgICA8SWNvbiB0eXBlPVwibWFpbFwiIGNsYXNzTmFtZT1cImljb24tZW1haWxcIiAvPlxyXG4gICAgICAgICAgPGEgaHJlZj17YG1haWx0bzoke2VtYWlsfWB9PntlbWFpbH08L2E+XHJcbiAgICAgICAgPC9wPlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1c2VyLXJlcG9zXCI+XHJcbiAgICAgICAgPFRhYnMgYWN0aXZlS2V5PXt0YWJLZXl9IG9uQ2hhbmdlPXtoYW5kbGVUYWJDaGFuZ2V9IGFuaW1hdGVkPXtmYWxzZX0+XHJcbiAgICAgICAgICA8VGFicy5UYWJQYW5lIHRhYj1cIuS9oOeahOS7k+W6k1wiIGtleT1cIjFcIj5cclxuICAgICAgICAgICAge3VzZXJSZXBvcy5tYXAoKHJlcG8pID0+IChcclxuICAgICAgICAgICAgICA8UmVwbyBrZXk9e3JlcG8uaWR9IHJlcG89e3JlcG99IC8+XHJcbiAgICAgICAgICAgICkpfVxyXG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XHJcbiAgICAgICAgICA8VGFicy5UYWJQYW5lIHRhYj1cIuS9oOWFs+azqOeahOS7k+W6k1wiIGtleT1cIjJcIj5cclxuICAgICAgICAgICAge3VzZXJTdGFyZWRSZXBvcy5tYXAoKHJlcG8pID0+IChcclxuICAgICAgICAgICAgICA8UmVwbyBrZXk9e3JlcG8uaWR9IHJlcG89e3JlcG99IC8+XHJcbiAgICAgICAgICAgICkpfVxyXG4gICAgICAgICAgPC9UYWJzLlRhYlBhbmU+XHJcbiAgICAgICAgPC9UYWJzPlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPHN0eWxlIGpzeD5cclxuICAgICAgICB7YFxyXG4gICAgICAgICAgLnJvb3Qge1xyXG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgICAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDtcclxuICAgICAgICAgICAgcGFkZGluZzogMjBweCAwO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC51c2VyLWluZm8ge1xyXG4gICAgICAgICAgICBmbGV4LXNocmluazogMDtcclxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgICAgICAgICAgd2lkdGg6IDIwMHB4O1xyXG4gICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDQwcHg7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLmxvZ2luIHtcclxuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDgwMDtcclxuICAgICAgICAgICAgZm9udC1zaXplOiAyMHB4O1xyXG4gICAgICAgICAgICBtYXJnaW4tdG9wOiAyMHB4O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC5uYW1lIHtcclxuICAgICAgICAgICAgZm9udC1zaXplOiAxNnB4O1xyXG4gICAgICAgICAgICBjb2xvcjogIzc3NztcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAuYmlvIHtcclxuICAgICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcclxuICAgICAgICAgICAgY29sb3I6ICMzMzM7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLmF2YXRhciB7XHJcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLnVzZXItcmVwb3Mge1xyXG4gICAgICAgICAgICBmbGV4OiAxO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIDpnbG9iYWwoLmljb24tZW1haWwpIHtcclxuICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIGB9XHJcbiAgICAgIDwvc3R5bGU+XHJcbiAgICA8L2Rpdj5cclxuICApXHJcbn1cclxuXHJcblxyXG5cclxuSW5kZXguZ2V0SW5pdGlhbFByb3BzID0gYXN5bmMgKHsgY3R4LCByZWR1eFN0b3JlIH0pID0+IHtcclxuXHJcbiAgY29uc3QgdXNlciA9IHJlZHV4U3RvcmUuZ2V0U3RhdGUoKS51c2VyXHJcblxyXG4gIGlmICghdXNlciB8fCAhdXNlci5pZCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNMb2dpbjogZmFsc2VcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlmKCFpc1NlcnZlcikge1xyXG4gICAgLy8gaWYgKGNhY2hlLmdldCgndXNlclJlcG9zJykgJiYgY2FjaGUuZ2V0KCd1c2VyU3RhcmVkUmVwb3MnKSApIHtcclxuICAgIC8vICAgcmV0dXJuIHtcclxuICAgIC8vICAgICB1c2VyUmVwb3M6IGNhY2hlLmdldCgndXNlclJlcG9zJyksXHJcbiAgICAvLyAgICAgdXNlclN0YXJlZFJlcG9zOiBjYWNoZS5nZXQoJ3VzZXJTdGFyZWRSZXBvcycpXHJcbiAgICAvLyAgIH1cclxuICAgIC8vIH1cclxuXHJcbiAgICBpZiAoY2FjaGVkVXNlclJlcG9zICYmIGNhY2hlZFVzZXJTdGFyZWRSZXBvcykge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHVzZXJSZXBvczogY2FjaGVkVXNlclJlcG9zLFxyXG4gICAgICAgIHVzZXJTdGFyZWRSZXBvczogY2FjaGVkVXNlclN0YXJlZFJlcG9zXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgXHJcblxyXG4gIGNvbnN0IHVzZXJSZXBvcyA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxyXG4gIHtcclxuICAgIHVybDogJy91c2VyL3JlcG9zJyxcclxuICB9LFxyXG4gIGN0eC5yZXEsXHJcbiAgY3R4LnJlc1xyXG4gIClcclxuXHJcbiAgXHJcblxyXG4gIGNvbnN0IHVzZXJTdGFyZWRSZXBvcyA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxyXG4gICAge1xyXG4gICAgICB1cmw6ICcvdXNlci9zdGFycmVkJyxcclxuICAgIH0sXHJcbiAgICBjdHgucmVxLFxyXG4gICAgY3R4LnJlc1xyXG4gICAgKVxyXG4gIFxyXG4gIFxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgaXNMb2dpbjogdHJ1ZSxcclxuICAgIHVzZXJSZXBvczogdXNlclJlcG9zLmRhdGEsXHJcbiAgICB1c2VyU3RhcmVkUmVwb3M6IHVzZXJTdGFyZWRSZXBvcy5kYXRhXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCB3aXRoUm91dGVyKGNvbm5lY3QoZnVuY3Rpb24gbWFwU3RhdGUoc3RhdGUpIHtcclxuICByZXR1cm4ge1xyXG4gICAgdXNlcjogc3RhdGUudXNlclxyXG4gIH1cclxufSkoSW5kZXgpKVxyXG5cclxuIl19 */\\n/*@ sourceURL=D:\\\\reactStudy\\\\Next-Koa-GitHub\\\\next-github\\\\pages\\\\index.js */\"));\n  }\n\n  const {\n    avatar_url,\n    login,\n    name,\n    bio,\n    email\n  } = user;\n\n  const handleTabChange = activeKey => {\n    Router.push(`/?key=${activeKey}`);\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-343846767\" + \" \" + \"root\"\n  }, __jsx(\"div\", {\n    className: \"jsx-343846767\" + \" \" + \"user-info\"\n  }, __jsx(\"img\", {\n    src: avatar_url,\n    alt: \"\",\n    className: \"jsx-343846767\" + \" \" + \"avatar\"\n  }), __jsx(\"span\", {\n    className: \"jsx-343846767\" + \" \" + \"login\"\n  }, login), __jsx(\"span\", {\n    className: \"jsx-343846767\" + \" \" + \"name\"\n  }, name), __jsx(\"span\", {\n    className: \"jsx-343846767\" + \" \" + \"bio\"\n  }, bio), __jsx(\"p\", {\n    className: \"jsx-343846767\" + \" \" + \"email\"\n  }, __jsx(_Icon, {\n    type: \"mail\",\n    className: \"icon-email\"\n  }), __jsx(\"a\", {\n    href: `mailto:${email}`,\n    className: \"jsx-343846767\"\n  }, email))), __jsx(\"div\", {\n    className: \"jsx-343846767\" + \" \" + \"user-repos\"\n  }, __jsx(_Tabs, {\n    activeKey: tabKey,\n    onChange: handleTabChange,\n    animated: false\n  }, __jsx(_Tabs.TabPane, {\n    tab: \"\\u4F60\\u7684\\u4ED3\\u5E93\",\n    key: \"1\"\n  }, userRepos.map(repo => __jsx(Repo, {\n    key: repo.id,\n    repo: repo\n  }))), __jsx(_Tabs.TabPane, {\n    tab: \"\\u4F60\\u5173\\u6CE8\\u7684\\u4ED3\\u5E93\",\n    key: \"2\"\n  }, userStaredRepos.map(repo => __jsx(Repo, {\n    key: repo.id,\n    repo: repo\n  }))))), __jsx(_JSXStyle, {\n    id: \"343846767\"\n  }, \".root.jsx-343846767{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:20px 0;}.user-info.jsx-343846767{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:200px;margin-right:40px;}.login.jsx-343846767{font-weight:800;font-size:20px;margin-top:20px;}.name.jsx-343846767{font-size:16px;color:#777;}.bio.jsx-343846767{margin-top:20px;color:#333;}.avatar.jsx-343846767{width:100%;border-radius:5px;}.user-repos.jsx-343846767{-webkit-flex:1;-ms-flex:1;flex:1;}.icon-email{margin-right:10px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFxyZWFjdFN0dWR5XFxOZXh0LUtvYS1HaXRIdWJcXG5leHQtZ2l0aHViXFxwYWdlc1xcaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBa0dTLEFBRzBCLEFBTUMsQUFRRSxBQU1ELEFBS0MsQUFLTCxBQUtKLEFBSVcsV0FSQSxJQVZQLENBTkksQUFXSixFQWNiLFFBbEJBLENBS0EsRUFLQSxFQWhCa0IsRUFvQmxCLGNBbkJBLFNBVmUsa0JBTlUsd0RBT0QscURBTlAsZUFDakIsVUFNYyxZQUNNLGtCQUNwQiIsImZpbGUiOiJEOlxccmVhY3RTdHVkeVxcTmV4dC1Lb2EtR2l0SHViXFxuZXh0LWdpdGh1YlxccGFnZXNcXGluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcblxyXG5jb25zdCBhcGkgPSByZXF1aXJlKCcuLi9saWIvYXBpJylcclxuaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnXHJcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcydcclxuaW1wb3J0IHsgQnV0dG9uLCBJY29uLCBUYWJzIH0gZnJvbSAnYW50ZCdcclxuaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4J1xyXG5pbXBvcnQgUm91dGVyLCB7IHdpdGhSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcclxuaW1wb3J0IFJlcG8gZnJvbSAnLi4vY29tcG9uZW50cy9SZXBvJ1xyXG5pbXBvcnQgTFJVIGZyb20gJ2xydS1jYWNoZSdcclxuXHJcbmltcG9ydCBnZXRDb25maWcgZnJvbSAnbmV4dC9jb25maWcnXHJcbmNvbnN0IHsgcHVibGljUnVudGltZUNvbmZpZyB9ID0gZ2V0Q29uZmlnKClcclxuY29uc3QgY2FjaGUgPSBuZXcgTFJVKHtcclxuICBtYXhBZ2U6IDEwMDAgKiA2MCAqIDEwICAvLyDljYHliIbpkp/lhoXkuI3kvJrkvb/nlKjnvJPlrZjnmoTmlbDmja7lsLHkvJrooqvliKDpmaRcclxufSlcclxuXHJcbmxldCBjYWNoZWRVc2VyUmVwb3M7XHJcbmxldCBjYWNoZWRVc2VyU3RhcmVkUmVwb3M7XHJcbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mICB3aW5kb3cgPT09ICd1bmRlZmluZWQnXHJcblxyXG5mdW5jdGlvbiBJbmRleCAoeyB1c2VyUmVwb3MsIHVzZXJTdGFyZWRSZXBvcywgdXNlciwgcm91dGVyIH0pIHtcclxuICBcclxuICBjb25zdCB0YWJLZXkgPSByb3V0ZXIucXVlcnkua2V5IHx8ICcxJ1xyXG4gIFxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZighaXNTZXJ2ZXIpIHtcclxuICAgICAgY2FjaGVkVXNlclJlcG9zID0gdXNlclJlcG9zXHJcbiAgICAgIGNhY2hlZFVzZXJTdGFyZWRSZXBvcyA9IHVzZXJTdGFyZWRSZXBvc1xyXG4gICAgICAvLyBpZih1c2VyUmVwb3MpIHtcclxuICAgICAgLy8gICBjYWNoZS5zZXQoJ3VzZXJSZXBvcycsIHVzZXJSZXBvcylcclxuICAgICAgLy8gfVxyXG4gICAgICAvLyBpZih1c2VyU3RhcmVkUmVwb3MpIHtcclxuICAgICAgLy8gICBjYWNoZS5zZXQoJ3VzZXJTdGFyZWRSZXBvcycsIHVzZXJTdGFyZWRSZXBvcylcclxuICAgICAgLy8gfVxyXG4gICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgY2FjaGVkVXNlclJlcG9zID0gbnVsbFxyXG4gICAgICAgIGNhY2hlZFVzZXJTdGFyZWRSZXBvcyA9IG51bGxcclxuICAgICAgfSwgMTAwMCAqIDYwICogMTApXHJcbiAgICB9XHJcbiAgfSxbdXNlclJlcG9zLCB1c2VyU3RhcmVkUmVwb3NdKVxyXG5cclxuICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxyXG4gICAgICAgIDxwPuS6su+8jOaCqOi/mOayoeacieeZu+W9leWTpjwvcD5cclxuICAgICAgICA8QnV0dG9uIHR5cGU9XCJwcmltYXJ5XCIgaHJlZj17cHVibGljUnVudGltZUNvbmZpZy5PQVVUSF9VUkx9PlxyXG4gICAgICAgICAg54K55Ye755m75b2VXHJcbiAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgPHN0eWxlIGpzeD5cclxuICAgICAgICAgIHtgXHJcbiAgICAgICAgICAgIC5yb290IHtcclxuICAgICAgICAgICAgICBoZWlnaHQ6IDQwMHB4O1xyXG4gICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICBgfVxyXG4gICAgICAgIDwvc3R5bGU+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgKVxyXG4gIH1cclxuXHJcbiAgY29uc3Qge1xyXG4gICAgYXZhdGFyX3VybCwgbG9naW4sIG5hbWUsIGJpbywgZW1haWwsXHJcbiAgfSA9IHVzZXJcclxuXHJcbiAgY29uc3QgaGFuZGxlVGFiQ2hhbmdlID0gKGFjdGl2ZUtleSkgPT4ge1xyXG4gICAgUm91dGVyLnB1c2goYC8/a2V5PSR7YWN0aXZlS2V5fWApXHJcbiAgfVxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1c2VyLWluZm9cIj5cclxuICAgICAgICA8aW1nIHNyYz17YXZhdGFyX3VybH0gYWx0PVwiXCIgY2xhc3NOYW1lPVwiYXZhdGFyXCIgLz5cclxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJsb2dpblwiPntsb2dpbn08L3NwYW4+XHJcbiAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibmFtZVwiPntuYW1lfTwvc3Bhbj5cclxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJiaW9cIj57YmlvfTwvc3Bhbj5cclxuICAgICAgICA8cCBjbGFzc05hbWU9XCJlbWFpbFwiPlxyXG4gICAgICAgICAgPEljb24gdHlwZT1cIm1haWxcIiBjbGFzc05hbWU9XCJpY29uLWVtYWlsXCIgLz5cclxuICAgICAgICAgIDxhIGhyZWY9e2BtYWlsdG86JHtlbWFpbH1gfT57ZW1haWx9PC9hPlxyXG4gICAgICAgIDwvcD5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidXNlci1yZXBvc1wiPlxyXG4gICAgICAgIDxUYWJzIGFjdGl2ZUtleT17dGFiS2V5fSBvbkNoYW5nZT17aGFuZGxlVGFiQ2hhbmdlfSBhbmltYXRlZD17ZmFsc2V9PlxyXG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSB0YWI9XCLkvaDnmoTku5PlupNcIiBrZXk9XCIxXCI+XHJcbiAgICAgICAgICAgIHt1c2VyUmVwb3MubWFwKChyZXBvKSA9PiAoXHJcbiAgICAgICAgICAgICAgPFJlcG8ga2V5PXtyZXBvLmlkfSByZXBvPXtyZXBvfSAvPlxyXG4gICAgICAgICAgICApKX1cclxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxyXG4gICAgICAgICAgPFRhYnMuVGFiUGFuZSB0YWI9XCLkvaDlhbPms6jnmoTku5PlupNcIiBrZXk9XCIyXCI+XHJcbiAgICAgICAgICAgIHt1c2VyU3RhcmVkUmVwb3MubWFwKChyZXBvKSA9PiAoXHJcbiAgICAgICAgICAgICAgPFJlcG8ga2V5PXtyZXBvLmlkfSByZXBvPXtyZXBvfSAvPlxyXG4gICAgICAgICAgICApKX1cclxuICAgICAgICAgIDwvVGFicy5UYWJQYW5lPlxyXG4gICAgICAgIDwvVGFicz5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxzdHlsZSBqc3g+XHJcbiAgICAgICAge2BcclxuICAgICAgICAgIC5yb290IHtcclxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XHJcbiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHggMDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAudXNlci1pbmZvIHtcclxuICAgICAgICAgICAgZmxleC1zaHJpbms6IDA7XHJcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgICAgICAgICAgIHdpZHRoOiAyMDBweDtcclxuICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiA0MHB4O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC5sb2dpbiB7XHJcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7XHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjBweDtcclxuICAgICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAubmFtZSB7XHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTZweDtcclxuICAgICAgICAgICAgY29sb3I6ICM3Nzc7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLmJpbyB7XHJcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XHJcbiAgICAgICAgICAgIGNvbG9yOiAjMzMzO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC5hdmF0YXIge1xyXG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcclxuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC51c2VyLXJlcG9zIHtcclxuICAgICAgICAgICAgZmxleDogMTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICA6Z2xvYmFsKC5pY29uLWVtYWlsKSB7XHJcbiAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMTBweDtcclxuICAgICAgICAgIH1cclxuICAgICAgICBgfVxyXG4gICAgICA8L3N0eWxlPlxyXG4gICAgPC9kaXY+XHJcbiAgKVxyXG59XHJcblxyXG5cclxuXHJcbkluZGV4LmdldEluaXRpYWxQcm9wcyA9IGFzeW5jICh7IGN0eCwgcmVkdXhTdG9yZSB9KSA9PiB7XHJcblxyXG4gIGNvbnN0IHVzZXIgPSByZWR1eFN0b3JlLmdldFN0YXRlKCkudXNlclxyXG5cclxuICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzTG9naW46IGZhbHNlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpZighaXNTZXJ2ZXIpIHtcclxuICAgIC8vIGlmIChjYWNoZS5nZXQoJ3VzZXJSZXBvcycpICYmIGNhY2hlLmdldCgndXNlclN0YXJlZFJlcG9zJykgKSB7XHJcbiAgICAvLyAgIHJldHVybiB7XHJcbiAgICAvLyAgICAgdXNlclJlcG9zOiBjYWNoZS5nZXQoJ3VzZXJSZXBvcycpLFxyXG4gICAgLy8gICAgIHVzZXJTdGFyZWRSZXBvczogY2FjaGUuZ2V0KCd1c2VyU3RhcmVkUmVwb3MnKVxyXG4gICAgLy8gICB9XHJcbiAgICAvLyB9XHJcblxyXG4gICAgaWYgKGNhY2hlZFVzZXJSZXBvcyAmJiBjYWNoZWRVc2VyU3RhcmVkUmVwb3MpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB1c2VyUmVwb3M6IGNhY2hlZFVzZXJSZXBvcyxcclxuICAgICAgICB1c2VyU3RhcmVkUmVwb3M6IGNhY2hlZFVzZXJTdGFyZWRSZXBvc1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG5cclxuICBjb25zdCB1c2VyUmVwb3MgPSBhd2FpdCBhcGkucmVxdWVzdChcclxuICB7XHJcbiAgICB1cmw6ICcvdXNlci9yZXBvcycsXHJcbiAgfSxcclxuICBjdHgucmVxLFxyXG4gIGN0eC5yZXNcclxuICApXHJcblxyXG4gIFxyXG5cclxuICBjb25zdCB1c2VyU3RhcmVkUmVwb3MgPSBhd2FpdCBhcGkucmVxdWVzdChcclxuICAgIHtcclxuICAgICAgdXJsOiAnL3VzZXIvc3RhcnJlZCcsXHJcbiAgICB9LFxyXG4gICAgY3R4LnJlcSxcclxuICAgIGN0eC5yZXNcclxuICAgIClcclxuICBcclxuICBcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGlzTG9naW46IHRydWUsXHJcbiAgICB1c2VyUmVwb3M6IHVzZXJSZXBvcy5kYXRhLFxyXG4gICAgdXNlclN0YXJlZFJlcG9zOiB1c2VyU3RhcmVkUmVwb3MuZGF0YVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgd2l0aFJvdXRlcihjb25uZWN0KGZ1bmN0aW9uIG1hcFN0YXRlKHN0YXRlKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHVzZXI6IHN0YXRlLnVzZXJcclxuICB9XHJcbn0pKEluZGV4KSlcclxuXHJcbiJdfQ== */\\n/*@ sourceURL=D:\\\\reactStudy\\\\Next-Koa-GitHub\\\\next-github\\\\pages\\\\index.js */\"));\n}\n\nIndex.getInitialProps = async ({\n  ctx,\n  reduxStore\n}) => {\n  const user = reduxStore.getState().user;\n\n  if (!user || !user.id) {\n    return {\n      isLogin: false\n    };\n  }\n\n  if (!isServer) {\n    // if (cache.get('userRepos') && cache.get('userStaredRepos') ) {\n    //   return {\n    //     userRepos: cache.get('userRepos'),\n    //     userStaredRepos: cache.get('userStaredRepos')\n    //   }\n    // }\n    if (cachedUserRepos && cachedUserStaredRepos) {\n      return {\n        userRepos: cachedUserRepos,\n        userStaredRepos: cachedUserStaredRepos\n      };\n    }\n  }\n\n  const userRepos = await api.request({\n    url: '/user/repos'\n  }, ctx.req, ctx.res);\n  const userStaredRepos = await api.request({\n    url: '/user/starred'\n  }, ctx.req, ctx.res);\n  return {\n    isLogin: true,\n    userRepos: userRepos.data,\n    userStaredRepos: userStaredRepos.data\n  };\n};\n\nexport default withRouter(connect(function mapState(state) {\n  return {\n    user: state.user\n  };\n})(Index));","map":{"version":3,"sources":["D:\\reactStudy\\Next-Koa-GitHub\\next-github\\pages\\index.js"],"names":["api","require","useEffect","axios","connect","Router","withRouter","Repo","LRU","getConfig","publicRuntimeConfig","cache","maxAge","cachedUserRepos","cachedUserStaredRepos","isServer","Index","userRepos","userStaredRepos","user","router","tabKey","query","key","timeout","setTimeout","id","OAUTH_URL","avatar_url","login","name","bio","email","handleTabChange","activeKey","push","map","repo","getInitialProps","ctx","reduxStore","getState","isLogin","request","url","req","res","data","mapState","state"],"mappings":"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","sourcesContent":["\r\n\r\nconst api = require('../lib/api')\r\nimport { useEffect } from 'react'\r\nimport axios from 'axios'\r\nimport { Button, Icon, Tabs } from 'antd'\r\nimport { connect } from 'react-redux'\r\nimport Router, { withRouter } from 'next/router'\r\nimport Repo from '../components/Repo'\r\nimport LRU from 'lru-cache'\r\n\r\nimport getConfig from 'next/config'\r\nconst { publicRuntimeConfig } = getConfig()\r\nconst cache = new LRU({\r\n  maxAge: 1000 * 60 * 10  // 十分钟内不会使用缓存的数据就会被删除\r\n})\r\n\r\nlet cachedUserRepos;\r\nlet cachedUserStaredRepos;\r\nconst isServer = typeof  window === 'undefined'\r\n\r\nfunction Index ({ userRepos, userStaredRepos, user, router }) {\r\n  \r\n  const tabKey = router.query.key || '1'\r\n  \r\n  useEffect(() => {\r\n    if(!isServer) {\r\n      cachedUserRepos = userRepos\r\n      cachedUserStaredRepos = userStaredRepos\r\n      // if(userRepos) {\r\n      //   cache.set('userRepos', userRepos)\r\n      // }\r\n      // if(userStaredRepos) {\r\n      //   cache.set('userStaredRepos', userStaredRepos)\r\n      // }\r\n      const timeout = setTimeout(() => {\r\n        cachedUserRepos = null\r\n        cachedUserStaredRepos = null\r\n      }, 1000 * 60 * 10)\r\n    }\r\n  },[userRepos, userStaredRepos])\r\n\r\n  if (!user || !user.id) {\r\n    return (\r\n      <div className=\"root\">\r\n        <p>亲，您还没有登录哦</p>\r\n        <Button type=\"primary\" href={publicRuntimeConfig.OAUTH_URL}>\r\n          点击登录\r\n        </Button>\r\n        <style jsx>\r\n          {`\r\n            .root {\r\n              height: 400px;\r\n              display: flex;\r\n              flex-direction: column;\r\n              justify-content: center;\r\n              align-items: center;\r\n            }\r\n          `}\r\n        </style>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const {\r\n    avatar_url, login, name, bio, email,\r\n  } = user\r\n\r\n  const handleTabChange = (activeKey) => {\r\n    Router.push(`/?key=${activeKey}`)\r\n  }\r\n  return (\r\n    <div className=\"root\">\r\n      <div className=\"user-info\">\r\n        <img src={avatar_url} alt=\"\" className=\"avatar\" />\r\n        <span className=\"login\">{login}</span>\r\n        <span className=\"name\">{name}</span>\r\n        <span className=\"bio\">{bio}</span>\r\n        <p className=\"email\">\r\n          <Icon type=\"mail\" className=\"icon-email\" />\r\n          <a href={`mailto:${email}`}>{email}</a>\r\n        </p>\r\n      </div>\r\n      <div className=\"user-repos\">\r\n        <Tabs activeKey={tabKey} onChange={handleTabChange} animated={false}>\r\n          <Tabs.TabPane tab=\"你的仓库\" key=\"1\">\r\n            {userRepos.map((repo) => (\r\n              <Repo key={repo.id} repo={repo} />\r\n            ))}\r\n          </Tabs.TabPane>\r\n          <Tabs.TabPane tab=\"你关注的仓库\" key=\"2\">\r\n            {userStaredRepos.map((repo) => (\r\n              <Repo key={repo.id} repo={repo} />\r\n            ))}\r\n          </Tabs.TabPane>\r\n        </Tabs>\r\n      </div>\r\n      <style jsx>\r\n        {`\r\n          .root {\r\n            display: flex;\r\n            align-items: flex-start;\r\n            padding: 20px 0;\r\n          }\r\n\r\n          .user-info {\r\n            flex-shrink: 0;\r\n            display: flex;\r\n            flex-direction: column;\r\n            width: 200px;\r\n            margin-right: 40px;\r\n          }\r\n\r\n          .login {\r\n            font-weight: 800;\r\n            font-size: 20px;\r\n            margin-top: 20px;\r\n          }\r\n\r\n          .name {\r\n            font-size: 16px;\r\n            color: #777;\r\n          }\r\n\r\n          .bio {\r\n            margin-top: 20px;\r\n            color: #333;\r\n          }\r\n\r\n          .avatar {\r\n            width: 100%;\r\n            border-radius: 5px;\r\n          }\r\n\r\n          .user-repos {\r\n            flex: 1;\r\n          }\r\n\r\n          :global(.icon-email) {\r\n            margin-right: 10px;\r\n          }\r\n        `}\r\n      </style>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\nIndex.getInitialProps = async ({ ctx, reduxStore }) => {\r\n\r\n  const user = reduxStore.getState().user\r\n\r\n  if (!user || !user.id) {\r\n    return {\r\n      isLogin: false\r\n    }\r\n  }\r\n\r\n  if(!isServer) {\r\n    // if (cache.get('userRepos') && cache.get('userStaredRepos') ) {\r\n    //   return {\r\n    //     userRepos: cache.get('userRepos'),\r\n    //     userStaredRepos: cache.get('userStaredRepos')\r\n    //   }\r\n    // }\r\n\r\n    if (cachedUserRepos && cachedUserStaredRepos) {\r\n      return {\r\n        userRepos: cachedUserRepos,\r\n        userStaredRepos: cachedUserStaredRepos\r\n      }\r\n    }\r\n  }\r\n  \r\n\r\n  const userRepos = await api.request(\r\n  {\r\n    url: '/user/repos',\r\n  },\r\n  ctx.req,\r\n  ctx.res\r\n  )\r\n\r\n  \r\n\r\n  const userStaredRepos = await api.request(\r\n    {\r\n      url: '/user/starred',\r\n    },\r\n    ctx.req,\r\n    ctx.res\r\n    )\r\n  \r\n  \r\n\r\n  return {\r\n    isLogin: true,\r\n    userRepos: userRepos.data,\r\n    userStaredRepos: userStaredRepos.data\r\n  }\r\n}\r\n\r\nexport default withRouter(connect(function mapState(state) {\r\n  return {\r\n    user: state.user\r\n  }\r\n})(Index))\r\n\r\n"]},"metadata":{},"sourceType":"module"}